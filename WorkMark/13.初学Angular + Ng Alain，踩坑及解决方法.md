# 13.初学Angular + Ng Alain，踩坑及解决方法

作者：罗永梅
时间：2019 年 06 月 12 日

### 一、Angular *ngFor 获取 index
普通遍历用法：
```
<ul>
　　<li *ngFor="let item in items">{{item}}</li>
</ul>
```
有时候需要获取index，可以这样用：
```
<ul>
    <li *ngFor="let item of items; let i = index">     
       {{ item }} 的索引是：{{ i }}
    </li>
</ul>
```

### 二、RxJS异步通信之Subject和BehaviorSubject
1. Subject 可以实现一个消息向多个订阅者推送消息
```
var subject = new Rx.Subject();   //实例化一个Subject对象
subject.next(1);                  //向接受者发送一个消息流

subject.subscribe({
    next: (value) => console.log('observerA: ' + value)  //接受者A订阅消息，获取消息流中的数据
});
subject.subscribe({
    next: (value) => console.log('observerB: ' + value)  //接受者B订阅消息，获取消息流中的数据
});
```

这样两路接受者都能拿到发送的数据流:
```
observerA:1
observerB:1
```

2. BehaviorSubject 是 Subject 的一个衍生类，它将数据流中的最新值推送给接受者
```
var subject = new Rx.BehaviorSubject(0); //声明一个BehaviorSubject对象
subject.next(1);           //发送一个数据流
subject.next(2);           //再发送一个数据流
subject.subscribe({
    next: (v) => console.log('observerA: ' + v)  //接受者A订阅消息
});
subject.subscribe({
    next: (v) => console.log('observerB: ' + v)  //接受者B订阅消息
});
subject.next(3);    //再发送一个数据流

```

这样，每次接受者只会接受最新最送的那个消息：
```
observerA:2
observerB:2
observerA:3
observerB:3
```